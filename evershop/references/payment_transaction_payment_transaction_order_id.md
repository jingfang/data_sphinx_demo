| path | summary | is relevant |
| --- | --- | --- |
| [packages/evershop/src/modules/checkout/graphql/types/PaymentTransaction/PaymentTransaction.resolvers.js](https://github.com/evershopcommerce/evershop/blob/bc7ee43cdadfb8a00e896c8f753da75938507854/packages/evershop/src/modules/checkout/graphql/types/PaymentTransaction/PaymentTransaction.resolvers.js) | <br><br>このコードでは、テーブルpayment_transactionのカラムpayment_transaction_order_idは、特定のorderIdに関連する支払いトランザクションを取得するための条件として使用されています。具体的には、select()メソッドでpayment_transactionテーブルからデータを取得する際に、where()メソッドを使用してpayment_transaction_order_idがorderIdと等しい行のみを取得しています。 | True |
| [packages/evershop/src/modules/checkout/migration/Version-1.0.0.js](https://github.com/evershopcommerce/evershop/blob/4f1f4947f95e03b9cf64486a42b1669d484cba61/packages/evershop/src/modules/checkout/migration/Version-1.0.0.js) | <br><br>テーブルpayment_transactionのカラムpayment_transaction_order_idは、外部キーとして使用されています。このカラムは、注文テーブル(order)の注文ID(order_id)と関連付けられており、支払いトランザクション(payment_transaction)がどの注文に関連しているかを示しています。また、このカラムは、注文が削除された場合に支払いトランザクションも削除されるように設定されています。 | True |
| [packages/evershop/src/modules/cod/api/codCapturePayment/[bodyParser]capture.js](https://github.com/evershopcommerce/evershop/blob/bc7ee43cdadfb8a00e896c8f753da75938507854/packages/evershop/src/modules/cod/api/codCapturePayment/[bodyParser]capture.js) | <br><br>このコードでは、テーブルpayment_transactionのカラムpayment_transaction_order_idは、新しい支払いトランザクションが作成される際に、そのトランザクションがどの注文に関連しているかを示すために使用されています。具体的には、insert('payment_transaction')メソッドで、given()メソッドを使用して、payment_transaction_order_idカラムにorder.order_idの値を設定しています。これにより、支払いトランザクションが注文に関連付けられ、将来的に注文と支払いトランザクションを関連付けるために使用されます。 | True |
| [packages/evershop/src/modules/paypal/api/paypalCapturePayment/[bodyParser]capture.js](https://github.com/evershopcommerce/evershop/blob/bc7ee43cdadfb8a00e896c8f753da75938507854/packages/evershop/src/modules/paypal/api/paypalCapturePayment/[bodyParser]capture.js) | このコードでは、payment_transactionテーブルのpayment_transaction_order_idカラムは、注文のIDを参照するために使用されています。具体的には、以下の行で使用されています。<br><br>```<br>await insert('payment_transaction')<br>  .given({<br>    payment_transaction_order_id: order.order_id,<br>    // 以下省略<br>  })<br>  .execute(pool);<br>```<br><br>この行では、注文のID（order.order_id）がpayment_transaction_order_idカラムにセットされ、payment_transactionテーブルに新しいトランザクションが挿入されます。つまり、payment_transaction_order_idカラムは、注文とトランザクションを関連付けるために使用されています。 | True |
| [packages/evershop/src/modules/paypal/api/paypalAuthorizePayment/[bodyParser]authorize.js](https://github.com/evershopcommerce/evershop/blob/bc7ee43cdadfb8a00e896c8f753da75938507854/packages/evershop/src/modules/paypal/api/paypalAuthorizePayment/[bodyParser]authorize.js) | このコードでは、payment_transactionテーブルのpayment_transaction_order_idカラムは、注文に関連する支払いトランザクションを識別するために使用されます。具体的には、authorize API呼び出しのレスポンスから取得したトランザクションIDや金額などの情報が、この注文に関連する支払いトランザクションとしてpayment_transactionテーブルに挿入されます。その際、payment_transaction_order_idカラムには、注文のIDが設定されます。これにより、注文と支払いトランザクションの関連性が確立されます。 | True |
| [packages/evershop/src/modules/checkout/migration/Version-1.0.1.js](https://github.com/evershopcommerce/evershop/blob/4f1f4947f95e03b9cf64486a42b1669d484cba61/packages/evershop/src/modules/checkout/migration/Version-1.0.1.js) | <br><br>テーブルpayment_transactionのカラムpayment_transaction_order_idは、外部キー制約として使用されています。具体的には、ALTER TABLE文でFK_PAYMENT_TRANSACTION_ORDERという名前のインデックスが作成されています。また、同じALTER TABLE文で、payment_transaction_order_idカラムに対する外部キー制約が削除されています。 | True |
| [packages/evershop/src/modules/stripe/api/stripeWebHook/[bodyJson]webhook.js](https://github.com/evershopcommerce/evershop/blob/bc7ee43cdadfb8a00e896c8f753da75938507854/packages/evershop/src/modules/stripe/api/stripeWebHook/[bodyJson]webhook.js) | このコードでは、payment_transaction_order_idカラムは、支払いトランザクションがどの注文に関連しているかを示すために使用されています。具体的には、支払いトランザクションが作成されるとき、このカラムに注文IDが設定されます。また、支払いが成功した場合、このカラムを使用して注文の支払いステータスを更新します。 | True |
[Back to payment_transaction](../tables/payment_transaction.md)